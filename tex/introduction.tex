\section{Introduction}
To protect the confidentiality of sensitive information stored in databases, it is essential to restrict access to the stated data.
%
For this, the SQL standard defines an access control model. And existing Database Management Systems (DBMSs) have implemented it. 
%
This access control model successfully regulates \emph{direct access}, i.e., through \texttt{SELECT} queries, to the data. It however falls far short of preventing \emph{indirect access} to sensitive data.
%
Namely, attackers can exploit advanced database features, such as triggers and views, as well as the DBMS' semantics to infer sensitive information from sequences of authorized commands~\cite{guarnieri2016strong}.
%

Recently, Guarnieri et al.~\cite{guarnieri2016strong} investigated the limitations of the SQL access control model. 
%
They identified severe of attacks. Attackers can carry out by exploiting advanced database features and the DBMS' semantics.
%
One of those families are \emph{confidentiality attacks}. These allow an attacker to infer sensitive information based on the system's behaviour.
%
They further developed a formal framework, consisting of formal database semantics and attacker model as well as precise security properties, to reason about the precise security guarantees offered by access control mechanisms in database systems.
%
Using this framework, they developed an access control mechanism that provably prevents both families of attacks.

Due to the gravity of the current situation, where the mentioned attacks can cause severe damage, this thesis explores the possibility of preventing confidentiality attacks in PostgreSQL, a widely used DBMS.

The mechanism proposed by Guarnieri et al., has several limitations in practice.
%
For one the formulated model is based on the relational calculus. 
%
Existing Database Management Systems (DBMSs), however, are based on SQL.
%
Despite SQL is inspired by the relational calculus, it differs from it in significant ways.
%
Thus, extending Guarnieri et al.'s mechanism to SQL poses several challenges, \remark{bag vs. set? for the confidentiality part we did not really have many problems right?}, and it is crucial to effectively secure state-of-the-art DBMSs.

\smallskip
\noindent
{\bf Contributions.}
%
In this thesis, we extend  the access control mechanism proposed by Guarnieri et al.~\cite{guarnieri2016strong} to SQL, and we integrate it inside PostgreSQL
%
First, we refactor the original PostgreSQL's implementation to isolate the access control mechanism and provide a general interface for access requests, independent of the type of query.
%
The original implementation requires a deep understanding of the backend architecture of PostgreSQL to be able to extend and improve the current access control algorithm.
%
Our refactoring provides the possibility of improving and extending access control without interfering with the internals of the DBMS.

Second, we extend the access control mechanism proposed by Guarnieri et al.~\cite{guarnieri2016strong} to SQL.
%
This is essential to effectively secure PostgreSQL and prevent leakages of sensitive information.
%
In more detail, we achieve this goal by computing over- and underapproximations of the tuples returned by a query. The query is only authorized iff the approximations contain the same set of tuples.
%
\remark{
As shown in our experiments, our mechanism introduces an overhead, on average, of XX\%, in contrast to Guarnieri et al.'s mechanism  that  has an overhead of ...X\cite{guarnieri2016strong}.
}
%
Furthermore, our algorithm is  more permissive than the PostgreSQL's mechanism, namely there are secure commands authorized by our solution and not authorized by PostgreSQL. etc.  

\smallskip
\noindent
{\bf Organization.}
%
In the next chapter we will introduce some motivating examples of attacks from both families. 
%
In chapter 3 we will give background information to access control by comparing current access control mechanism to the model introduced in~\cite{guarnieri2016strong}.
%
After that we will introduce the architecture of PostgreSQL and the new access control algorithm in chapter 4. 
%
In chapter 5 we will begin by showing the formal models of all aspects of the new security defintions and how they are extended from the relational algebra to SQL. 
%
Furthermore we will conduct experiments with state-of-the-art benchmark databases and queries in chapter 6. 
%
In chapter 7 we will introduce some related work to the thesis. 
%
Finally in chapter 8 the conclusions are drawn and future possibilities are discussed.